<?php
require_once __DIR__ . '/../config.php';

const QUESTIONNAIRE_TEMPLATE_B64 = <<<'B64'
UEsDBBQAAAAIANoLTFvwbmQ+DQEAALgCAAATAAAAW0NvbnRlbnRfVHlwZXNdLnhtbK1SO0/DMBDe
+yu8eahqtwwIoSQdeIzAUH7A4Vwaq37J55bk3+O4PCREgaHT6fQ9dbpqPVjDDhhJe1fzlVhyhk75
VrttzZ8394srziiBa8F4hzUfkfi6mVWbMSCxLHZU8z6lcC0lqR4tkPABXUY6Hy2kvMatDKB2sEV5
sVxeSuVdQpcWafLgzYyx6hY72JvE7oaMHLtENMTZzZE7xdUcQjBaQcq4PLj2W9DiPURkZeFQrwPN
M4HLUyETeDrjS/qYTxR1i+wJYnoAm4lyMPLVx92L9zvxu88PXX3XaYWtV3ubJYJCRGipR0zWiDKF
Be3m/6pQ+CTLWJ25y6f/31UojQbp3Lcoph/hlSyP17wBUEsDBBQAAAAIANoLTFtMBRKOtAAAACwB
AAALAAAAX3JlbHMvLnJlbHONz78OgjAQBvCdp+h2kxQcjDEUFmPCavABajn+hNJr2qrw9nYU4+B4
uft+l6+ollmzJzo/khGQpxkwNIra0fQCbs1ldwTmgzSt1GRQwIoeqjIprqhliBk/jNaziBgvYAjB
njj3asBZ+pQsmrjpyM0yxNH13Eo1yR75PssO3H0aUCaMbVhWtwJc3ebAmtXiPzx13ajwTOoxowk/
vnxdRFm6HoOARfMXuelONKURBR478k3J8g1QSwMEFAAAAAgA2gtMW4zkItfLAAAArwEAABoAAAB4
bC9fcmVscy93b3JrYm9vay54bWwucmVsc62QTYvCQAyG7/6KueVk03oQWTr1IoJXcX/AME0/sJ0Z
JvGj/34HRVlBYQ97Cm9CnjykXF/HQZ0pcu+dhiLLQZGzvu5dq+H7sJ2vQLEYV5vBO9IwEcO6mpV7
GoykHe76wCpBHGvoRMIXItuORsOZD+TSpPFxNJJibDEYezQt4SLPlxh/M6CaKfWCVbtaQ9zVBajD
FOgveN80vaWNt6eRnLy5ghcfj9wRSYKa2JJoeLYYb6XIEhXwo8/iP31YpiG99Clzzw+DEl/+XP0A
UEsDBBQAAAAIANoLTFv4XCLu5QAAAGoBAAAPAAAAeGwvd29ya2Jvb2sueG1sjZDNTsNADITvfYq9
+UQ3QQhBlaQXhNQLAgm4m6zTrLp/srdQ3p5N0ty52RrNN2M3+4t36ptYbAwt1NsKFIU+GhuOLXy8
P988gJKMwaCLgVr4JYF9t2l+Ip++Yjyp4g/Swphz2mkt/UgeZRsThaIMkT3msvJRS2JCIyNR9k7f
VtW99mgDLIQd/4cRh8H29BT7s6eQFwiTw1zay2iTQLdRqhmso8/lJoUpvaAvzS8O9Kyu1V9ZGcxU
P1Z3LVRXce4n07guKsz2tzPJFBPQMpWfTNLBlJeB4p0tAx9MfYXoldLoNaz7A1BLAwQUAAAACADa
C0xbAXIvizIBAAB7AgAADQAAAHhsL3N0eWxlcy54bWylkj1vwyAQhvf8CrabGpIMVVUZR1ksdemS
VOpKbZwgHQcCHNn99QWTpInUrRN37x3Pe3xU29EgOysftCUB6+UKmKLWdpqOAj4OzdMLsBAldRIt
KQGTCrCtF1WIE6r9SanIEoGCgFOM7pXz0J6UkWFpnaJU6a03MqbUH3lwXsku5E0G+Wa1euZGaoJ6
wVjVW4qBtXagmOaAehbqiqRR7CxRwM5ricBTQRqNUxE3WQjfJVmvc8bLxnkJBa0RH9FJqCsnY1Se
mpSwS3yYXDojpZMW0tw3L4X0ZX2X7uqeVaTcfSnOja1C3Ocr+uwfusee0WAaE986Aemu85DXMLlc
wkIqSSbf0274f5OZdA6nxhbC1efeYvZ8cLmpLD+MgPf8vAhs7K8Gg8ao6Y/ZE7biv9+m/gFQSwME
FAAAAAgA2gtMW2RbWQ82AgAAsAYAABgAAAB4bC93b3Jrc2hlZXRzL3NoZWV0MS54bWydVVFv2jAQ
fu+vuDdvUoeBrt00hVRdabc+bB2Frc8mORKLxI7so8C/3yUQNCqcTZPycHfO933OffE5ut6UBbyg
89qakRj0+gLQJDbVJhuJn7P7dx8FeFImVYU1OBJb9OI6PovW1i19jkjABMaPRE5UfZLSJzmWyvds
hYZXFtaVijh1mfSVQ5U2oLKQw37/SpZKGxGfAURN+ZfGta/TPwtAaj7FAhPClHcooJaeW7usFx+4
1BeyoZDHHDuG+2YDPxykuFCrgp7s+ivqLCemutwDE1u0qhxCqU2jU6rNSFyxnk4pH4nhewHJypMt
n3eFQavb4neKY0Vqz+bsGlz94i6v+ev8hslZX5tCG5ySE3GkfRxRPOWPZB8iSXEk65JMjpGfQ8jJ
Cn0NhVubYhh/+1f8DDcUxo9D+Cf0lTUeYbatOvTvQvjHqlb38CaxZanAY6WcYsOBfyBIcqsTlIVe
oqO3Yfb7EPtz4zhImCbWndheJNmpY8+Grz0bBri/oEGnig7PQsjJoMOoEGiMPnF6jkA5AjerQuLz
uoU58okF5T3yk3Y4GCLedbfDuhCQY2uyYgup9ipziOfjNviOK+LenN802eHFZrHDxpDSiX6dcO7i
tXMX/+1cCDkZdjgXAj2uqC4BbqpmlgG+6JS96+jEOMRFnaf0LgTr6Pm/Qw4t3w/cdt5Flcrwm3KZ
5nNc4ILp+r0PAtxu2jYx2aqJLgXMLfEobbOcbwZ0dcYbWVhLbcIjNpKHyyb+DVBLAQIUAxQAAAAI
ANoLTFvwbmQ+DQEAALgCAAATAAAAAAAAAAAAAACAAQAAAABbQ29udGVudF9UeXBlc10ueG1sUEsB
AhQDFAAAAAgA2gtMW0wFEo60AAAALAEAAAsAAAAAAAAAAAAAAIABPgEAAF9yZWxzLy5yZWxzUEsB
AhQDFAAAAAgA2gtMW4zkItfLAAAArwEAABoAAAAAAAAAAAAAAIABGwIAAHhsL19yZWxzL3dvcmti
b29rLnhtbC5yZWxzUEsBAhQDFAAAAAgA2gtMW/hcIu7lAAAAagEAAA8AAAAAAAAAAAAAAIABHgMA
AHhsL3dvcmtib29rLnhtbFBLAQIUAxQAAAAIANoLTFsBci+LMgEAAHsCAAANAAAAAAAAAAAAAACA
ATAEAAB4bC9zdHlsZXMueG1sUEsBAhQDFAAAAAgA2gtMW2RbWQ82AgAAsAYAABgAAAAAAAAAAAAA
AIABjQUAAHhsL3dvcmtzaGVldHMvc2hlZXQxLnhtbFBLBQYAAAAABgAGAIABAAD5BwAAAAA=
B64;

$clean = str_replace(["\r", "\n"], '', QUESTIONNAIRE_TEMPLATE_B64);
$data = base64_decode($clean, true);
if ($data === false) {
    http_response_code(500);
    header('Content-Type: text/plain; charset=UTF-8');
    echo 'Questionnaire template is currently unavailable.';
    exit;
}

header('Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');
header('Content-Disposition: attachment; filename="questionnaire_template.xlsx"');
header('Content-Length: ' . strlen($data));
header('Cache-Control: no-store, no-cache, must-revalidate');
header('Pragma: no-cache');

echo $data;
exit;
